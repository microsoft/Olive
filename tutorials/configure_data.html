<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>How To Configure Data &mdash; Olive  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/autodoc_pydantic.css" />
      <link rel="stylesheet" type="text/css" href="../_static/tabs.css?v=a5c4661c" />
      <link rel="stylesheet" type="text/css" href="../_static/css/width.css?v=b55249da" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=b3ba4146"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
        <script src="../_static/tabs.js?v=3030b3cb"></script>
        <script src="../_static/js/custom_version.js?v=3856a39b"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="How To Set Model Path" href="configure_model_path.html" />
    <link rel="prev" title="How To Configure Pass" href="configure_pass.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Olive
          </a>
              <div class="version">
                latest
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">OVERVIEW</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../overview/olive.html">Olive</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview/quicktour.html">Quick Tour</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview/options.html">Olive Options</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">GET STARTED</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../getstarted/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getstarted/quickstart_examples.html">Quickstart Examples</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">EXAMPLES</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../examples.html">Examples</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">FEATURES</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../features/cli.html">Command Line Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../features/model_transformations_and_optimizations.html">Model Transformations and Optimizations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../features/huggingface_model_optimization.html">Huggingface Model Optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../features/packaging_output_models.html">Packaging Olive artifacts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../features/custom_scripts.html">Custom Scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../features/azureml_integration.html">Azure ML integration</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">EXTENDING OLIVE</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../extending_olive/design.html">Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../extending_olive/how_to_add_optimization_pass.html">How to add new optimization Pass</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">TUTORIALS</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="configure_systems.html">How To Configure System</a></li>
<li class="toctree-l1"><a class="reference internal" href="configure_metrics.html">How To Configure Metric</a></li>
<li class="toctree-l1"><a class="reference internal" href="configure_auto_optimizer.html">How To Configure Auto Optimizer</a></li>
<li class="toctree-l1"><a class="reference internal" href="configure_pass.html">How To Configure Pass</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">How To Configure Data</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#supported-data-config-template">Supported Data Config Template</a></li>
<li class="toctree-l2"><a class="reference internal" href="#generic-data-config">Generic Data Config</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#configs-with-built-in-component">Configs with built-in component:</a></li>
<li class="toctree-l3"><a class="reference internal" href="#configs-with-customized-component">Configs with customized component:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="configure_model_path.html">How To Set Model Path</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced_users.html">Advanced User Tour</a></li>
<li class="toctree-l1"><a class="reference internal" href="azure_arc.html">Self-hosted Kubernetes cluster</a></li>
<li class="toctree-l1"><a class="reference internal" href="azureml_scripts.html">Azure ML scripts</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API REFERENCE</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/models.html">OliveModels</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/resource_path.html">ResourcePath</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/systems.html">OliveSystems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/evaluator.html">OliveEvaluator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/metric.html">Metric</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/search-algorithms.html">SearchAlgorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/engine.html">Engine</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/passes.html">Passes</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Olive</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">How To Configure Data</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/tutorials/configure_data.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="how-to-configure-data">
<span id="id1"></span><h1>How To Configure Data<a class="headerlink" href="#how-to-configure-data" title="Permalink to this heading">¶</a></h1>
<p>Olive Data config organizes the data loading, preprocessing, batching and post processing into a single json config and defines several <strong>popular templates</strong> to serve Olive optimization.</p>
<p>The configuration of Olive data config is positioned under Olive run config with the field of <code class="docutils literal notranslate"><span class="pre">data_configs</span></code>, and the data config is defined as a list of data config items. Here is an example of data config: <a class="reference external" href="https://github.com/microsoft/Olive/blob/main/examples/open_llama/open_llama_sparsegpt_gpu.json#L11-L49">open_llama_sparsegpt_gpu</a> .</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;data_configs&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;dataset_1&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">},</span>
    <span class="p">{</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;dataset_2&quot;</span><span class="p">,</span> <span class="o">...</span><span class="p">},</span>
<span class="p">]</span>
</pre></div>
</div>
<p>Note: <cite>name</cite> for each dataset should be unique, and must be composed letters, numbers, and underscores.</p>
<p>Then if there is any requirement to leverage the data config in Olive passes/evaluator, we can simply refer to the data config <strong>key name</strong>. For above <cite>open_llama_sparsegpt_gpu</cite> case, the passes/evaluator data config is:
<a class="reference external" href="https://github.com/microsoft/Olive/blob/main/examples/open_llama/open_llama_sparsegpt_gpu.json#L59">open_llama_sparsegpt_gpu data_config reference</a> .</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;evaluators&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;common_evaluator&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="o">...</span><span class="p">,</span>
        <span class="s2">&quot;data_config&quot;</span><span class="p">:</span> <span class="s2">&quot;dataset_1&quot;</span>
    <span class="p">},</span>
    <span class="o">...</span>
<span class="p">},</span>
<span class="s2">&quot;passes&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;common_pass&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="o">...</span><span class="p">,</span>
        <span class="s2">&quot;data_config&quot;</span><span class="p">:</span> <span class="s2">&quot;dataset_2&quot;</span>
    <span class="p">},</span>
    <span class="o">...</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Before deep dive to the generic data config, let’s first take a look at the data config template.</p>
<section id="supported-data-config-template">
<h2>Supported Data Config Template<a class="headerlink" href="#supported-data-config-template" title="Permalink to this heading">¶</a></h2>
<p>The data config template is defined in <a class="reference external" href="https://github.com/microsoft/Olive/blob/main/olive/data/template.py">olive.data.template</a> module which is used to create data_config easily.</p>
<p>Currently, we support the following data container which can be generated from <code class="docutils literal notranslate"><span class="pre">olive.data.template</span></code>:</p>
<p>1. DummyDataContainer:
Convert the dummy data config to the data container.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-0-0-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-0-0-0" name="0-0" role="tab" tabindex="0">Config JSON</button><button aria-controls="panel-0-0-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-0-0-1" name="0-1" role="tab" tabindex="-1">Python Class</button></div><div aria-labelledby="tab-0-0-0" class="sphinx-tabs-panel" id="panel-0-0-0" name="0-0" role="tabpanel" tabindex="0"><div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;dummy_data_config_template&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;DummyDataContainer&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;load_dataset_config&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;params&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;input_shapes&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">128</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">128</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">128</span><span class="p">]],</span>
<span class="w">            </span><span class="nt">&quot;input_names&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;input_ids&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;attention_mask&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;token_type_ids&quot;</span><span class="p">],</span>
<span class="w">            </span><span class="nt">&quot;input_types&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;int64&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;int64&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;int64&quot;</span><span class="p">],</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-0-0-1" class="sphinx-tabs-panel" hidden="true" id="panel-0-0-1" name="0-1" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">olive.data.config</span> <span class="kn">import</span> <span class="n">DataConfig</span>
<span class="n">data_config</span> <span class="o">=</span> <span class="n">DataConfig</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;dummy_data_config_template&quot;</span><span class="p">,</span>
    <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;DummyDataContainer&quot;</span><span class="p">,</span>
    <span class="n">load_dataset_config</span><span class="o">=</span><span class="n">DataComponentConfig</span><span class="p">(</span><span class="n">params</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;input_shapes&quot;</span><span class="p">:</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">128</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">128</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">128</span><span class="p">]],</span>
        <span class="s2">&quot;input_names&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;input_ids&quot;</span><span class="p">,</span> <span class="s2">&quot;attention_mask&quot;</span><span class="p">,</span> <span class="s2">&quot;token_type_ids&quot;</span><span class="p">],</span>
        <span class="s2">&quot;input_types&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;int64&quot;</span><span class="p">,</span> <span class="s2">&quot;int64&quot;</span><span class="p">,</span> <span class="s2">&quot;int64&quot;</span><span class="p">],</span>
    <span class="p">})</span>
<span class="p">)</span>
</pre></div>
</div>
</div></div>
<p>2. HuggingfaceContainer:
Convert the huggingface data config to the data container.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-1-1-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-1-1-0" name="1-0" role="tab" tabindex="0">Config JSON</button><button aria-controls="panel-1-1-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-1-1-1" name="1-1" role="tab" tabindex="-1">Python Class</button></div><div aria-labelledby="tab-1-1-0" class="sphinx-tabs-panel" id="panel-1-1-0" name="1-0" role="tabpanel" tabindex="0"><div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;huggingface_data_config&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;HuggingfaceContainer&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;load_dataset_config&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;params&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;data_name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;glue&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;split&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;validation&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;subset&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;mrpc&quot;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;pre_process_data_config&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;params&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;model_name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Intel/bert-base-uncased-mrpc&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;task&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;text-classification&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;input_cols&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;sentence1&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;sentence2&quot;</span><span class="p">],</span>
<span class="w">            </span><span class="nt">&quot;label_cols&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">]</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;post_process_data_config&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;params&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;task&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;text-classification&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;dataloader_config&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;params&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;batch_size&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-1-1-1" class="sphinx-tabs-panel" hidden="true" id="panel-1-1-1" name="1-1" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">olive.data.config</span> <span class="kn">import</span> <span class="n">DataConfig</span>
<span class="n">data_config</span> <span class="o">=</span> <span class="n">DataConfig</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;huggingface_data_config&quot;</span><span class="p">,</span>
    <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;HuggingfaceContainer&quot;</span><span class="p">,</span>
    <span class="n">load_dataset_config</span><span class="o">=</span><span class="n">DataComponentConfig</span><span class="p">(</span><span class="n">params</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;model_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Intel/bert-base-uncased-mrpc&quot;</span><span class="p">,</span>
        <span class="s2">&quot;task&quot;</span><span class="p">:</span> <span class="s2">&quot;text-classification&quot;</span><span class="p">,</span>
        <span class="s2">&quot;data_name&quot;</span><span class="p">:</span> <span class="s2">&quot;glue&quot;</span><span class="p">,</span>
        <span class="s2">&quot;split&quot;</span><span class="p">:</span> <span class="s2">&quot;validation&quot;</span><span class="p">,</span>
        <span class="s2">&quot;subset&quot;</span><span class="p">:</span> <span class="s2">&quot;mrpc&quot;</span><span class="p">,</span>
    <span class="p">}),</span>
    <span class="n">pre_process_data_config</span><span class="o">=</span><span class="n">DataComponentConfig</span><span class="p">(</span><span class="n">params</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;input_cols&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;sentence1&quot;</span><span class="p">,</span> <span class="s2">&quot;sentence2&quot;</span><span class="p">],</span>
        <span class="s2">&quot;label_cols&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">],</span>
    <span class="p">})</span>
    <span class="n">dataloader_config</span><span class="o">=</span><span class="n">DataComponentConfig</span><span class="p">(</span><span class="n">params</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;batch_size&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="p">})</span>
<span class="p">)</span>
</pre></div>
</div>
</div></div>
<p>3. RawDataContainer:
Convert the raw data config to the data container.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-2-2-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-2-2-0" name="2-0" role="tab" tabindex="0">Config JSON</button><button aria-controls="panel-2-2-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-2-2-1" name="2-1" role="tab" tabindex="-1">Python Class</button></div><div aria-labelledby="tab-2-2-0" class="sphinx-tabs-panel" id="panel-2-2-0" name="2-0" role="tabpanel" tabindex="0"><div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;raw_data&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;RawDataContainer&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;load_dataset_config&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;params&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;data_dir&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;data&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;input_names&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;data&quot;</span><span class="p">],</span>
<span class="w">            </span><span class="nt">&quot;input_shapes&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">224</span><span class="p">,</span><span class="w"> </span><span class="mi">224</span><span class="p">]],</span>
<span class="w">            </span><span class="nt">&quot;input_dirs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;.&quot;</span><span class="p">],</span>
<span class="w">            </span><span class="nt">&quot;input_suffix&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;.raw&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;input_order_file&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;input_order.txt&quot;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-2-2-1" class="sphinx-tabs-panel" hidden="true" id="panel-2-2-1" name="2-1" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">olive.data.config</span> <span class="kn">import</span> <span class="n">DataConfig</span>
<span class="n">data_config</span> <span class="o">=</span> <span class="n">DataConfig</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;raw_data&quot;</span><span class="p">,</span>
    <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;RawDataContainer&quot;</span><span class="p">,</span>
    <span class="n">load_dataset_config</span><span class="o">=</span><span class="n">DataComponentConfig</span><span class="p">(</span><span class="n">params</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;data_dir&quot;</span><span class="p">:</span> <span class="s2">&quot;data&quot;</span><span class="p">,</span>
        <span class="s2">&quot;input_names&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;data&quot;</span><span class="p">],</span>
        <span class="s2">&quot;input_shapes&quot;</span><span class="p">:</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">224</span><span class="p">,</span> <span class="mi">224</span><span class="p">]],</span>
        <span class="s2">&quot;input_dirs&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;.&quot;</span><span class="p">],</span>
        <span class="s2">&quot;input_suffix&quot;</span><span class="p">:</span> <span class="s2">&quot;.raw&quot;</span><span class="p">,</span>
        <span class="s2">&quot;input_order_file&quot;</span><span class="p">:</span> <span class="s2">&quot;input_order.txt&quot;</span>
    <span class="p">})</span>
<span class="p">)</span>
</pre></div>
</div>
</div></div>
<p>4. TransformersDummyDataContainer:
Convert the transformer dummy data config to the data container.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-3-3-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-3-3-0" name="3-0" role="tab" tabindex="0">Config JSON</button><button aria-controls="panel-3-3-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-3-3-1" name="3-1" role="tab" tabindex="-1">Python Class</button></div><div aria-labelledby="tab-3-3-0" class="sphinx-tabs-panel" id="panel-3-3-0" name="3-0" role="tabpanel" tabindex="0"><div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;transformers_dummy_data_config&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;TransformersDummyDataContainer&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-3-3-1" class="sphinx-tabs-panel" hidden="true" id="panel-3-3-1" name="3-1" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">olive.data.config</span> <span class="kn">import</span> <span class="n">DataConfig</span>
<span class="n">data_config</span> <span class="o">=</span> <span class="n">DataConfig</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;transformers_dummy_data_config&quot;</span><span class="p">,</span>
    <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;TransformersDummyDataContainer&quot;</span><span class="p">,</span>
    <span class="n">load_dataset_config</span><span class="o">=</span><span class="n">DataComponentConfig</span><span class="p">(</span><span class="n">params</span><span class="o">=</span><span class="p">{</span>
        <span class="c1"># model_name can be filled with the model name in input model&#39;s model_path</span>
        <span class="c1"># if you start olive with olive run --config &lt;config_path&gt;</span>
        <span class="s2">&quot;model_name&quot;</span><span class="p">:</span> <span class="s2">&quot;meta-llama/Llama-2-7b-hf&quot;</span>
    <span class="p">})</span>
<span class="p">)</span>
</pre></div>
</div>
</div><p>Also, based on <code class="docutils literal notranslate"><span class="pre">TransformersDummyDataContainer</span></code>, Olive provides templates for transformer inference based on prompt(first prediction, no kv_cache now) and token(with kv_cache) inputs.
- <code class="docutils literal notranslate"><span class="pre">TransformersPromptDummyDataContainer</span></code> where <code class="docutils literal notranslate"><span class="pre">seq_len</span></code> &gt;= 1(default 8) and <code class="docutils literal notranslate"><span class="pre">past_seq_len</span></code> = 0.
- <code class="docutils literal notranslate"><span class="pre">TransformersTokenDummyDataContainer</span></code> where <code class="docutils literal notranslate"><span class="pre">seq_len</span></code> == 1 and <code class="docutils literal notranslate"><span class="pre">past_seq_len</span></code> &gt;= 1(default 8).</p>
</div>
</section>
<section id="generic-data-config">
<h2>Generic Data Config<a class="headerlink" href="#generic-data-config" title="Permalink to this heading">¶</a></h2>
<dl>
<dt>If no data config template can meet the requirement, we can also define the <a class="reference external" href="https://github.com/microsoft/Olive/blob/main/olive/data/config.py#L35">data config</a> directly. The data config is defined as a dictionary which includes the following fields:</dt><dd><ol class="arabic">
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code>: the name of the data config.</p></li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">type</span></code>: the type name of the data config. Available <code class="docutils literal notranslate"><span class="pre">type</span></code>:</dt><dd><ul class="simple">
<li><p><a class="reference external" href="https://github.com/microsoft/Olive/blob/main/olive/data/container/data_container.py#L17">DataContainer</a> : the base class of all data config.</p></li>
<li><p><a class="reference external" href="https://github.com/microsoft/Olive/blob/main/olive/data/template.py#L9">DummyDataContainer</a> in above section.</p></li>
<li><p><a class="reference external" href="https://github.com/microsoft/Olive/blob/main/olive/data/template.py#L9">HuggingfaceContainer</a> in above section.</p></li>
<li><p><a class="reference external" href="https://github.com/microsoft/Olive/blob/main/olive/data/template.py#L72">RawDataContainer</a> in above section.</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl>
<dt><code class="docutils literal notranslate"><span class="pre">components</span></code>: the dictionary of four <a class="reference external" href="https://github.com/microsoft/Olive/blob/main/olive/data/constants.py#L12">components</a> which contain:</dt><dd><table class="docutils align-default" id="id2">
<caption><span class="caption-text">Title</span><a class="headerlink" href="#id2" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20.0%" />
<col style="width: 80.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Components</p></th>
<th class="head"><p>Available component type</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference external" href="https://github.com/microsoft/Olive/blob/main/olive/data/component/load_dataset.py">load_dataset</a></p></td>
<td><p>local_dataset(default), simple_dataset, huggingface_dataset, raw_dataset</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="https://github.com/microsoft/Olive/blob/main/olive/data/component/pre_process_data.py">pre_process_data</a></p></td>
<td><p>pre_process(default), huggingface_pre_process, ner_huggingface_preprocess, text_generation_huggingface_pre_process</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference external" href="https://github.com/microsoft/Olive/blob/main/olive/data/component/post_process_data.py">post_process_data</a></p></td>
<td><p>post_process(default), text_classification_post_process, ner_post_process, text_generation_post_process</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="https://github.com/microsoft/Olive/blob/main/olive/data/component/dataloader.py">dataloader</a></p></td>
<td><p>default_dataloader(default), no_auto_batch_dataloader</p></td>
</tr>
</tbody>
</table>
<dl class="simple">
<dt>each component can be customized by the following fields:</dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code>: the name of the component.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">type</span></code>: the type name of the available component type. Besides the above available type in above table, user can also define their own component type in <code class="docutils literal notranslate"><span class="pre">user_script</span></code> with the way Olive does for <a class="reference external" href="https://github.com/microsoft/Olive/blob/main/olive/data/component/load_dataset.py#L26">huggingface_dataset</a>. In this way, they need to provide <code class="docutils literal notranslate"><span class="pre">user_script</span></code> and <code class="docutils literal notranslate"><span class="pre">script_dir</span></code>. There is an <a class="reference external" href="https://github.com/microsoft/Olive/blob/main/examples/inception/user_script.py#L9">example</a> with customized component type.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">params</span></code>: the dictionary of component function parameters. The key is the parameter name for given component type and the value is the parameter value.</p></li>
</ul>
</dd>
</dl>
</dd>
</dl>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">user_script</span></code>: the user script path which contains the customized component type.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">script_dir</span></code>: the user script directory path which contains the customized script.</p></li>
</ol>
</dd>
</dl>
<section id="configs-with-built-in-component">
<h3>Configs with built-in component:<a class="headerlink" href="#configs-with-built-in-component" title="Permalink to this heading">¶</a></h3>
<p>Then the complete config would be like:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-4-4-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-4-4-0" name="4-0" role="tab" tabindex="0">Config JSON</button><button aria-controls="panel-4-4-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-4-4-1" name="4-1" role="tab" tabindex="-1">Python Class</button></div><div aria-labelledby="tab-4-4-0" class="sphinx-tabs-panel" id="panel-4-4-0" name="4-0" role="tabpanel" tabindex="0"><div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;data&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;DataContainer&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;load_dataset_config&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;huggingface_dataset&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;params&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;data_dir&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;data_name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;glue&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;subset&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;mrpc&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;split&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;validation&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;data_files&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;pre_process_data_config&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;huggingface_pre_process&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;params&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;model_name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Intel/bert-base-uncased-mrpc&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;input_cols&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                </span><span class="s2">&quot;sentence1&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="s2">&quot;sentence2&quot;</span>
<span class="w">            </span><span class="p">],</span>
<span class="w">            </span><span class="nt">&quot;label_cols&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                </span><span class="s2">&quot;label&quot;</span>
<span class="w">            </span><span class="p">],</span>
<span class="w">            </span><span class="nt">&quot;max_samples&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;post_process_data_config&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;text_classification_post_process&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;params&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;dataloader_config&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;default_dataloader&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;params&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;batch_size&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-4-4-1" class="sphinx-tabs-panel" hidden="true" id="panel-4-4-1" name="4-1" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">olive.data.config</span> <span class="kn">import</span> <span class="n">DataConfig</span>
<span class="n">data_config</span> <span class="o">=</span> <span class="n">DataConfig</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">,</span>
    <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;DataContainer&quot;</span><span class="p">,</span>
    <span class="n">load_dataset_config</span><span class="o">=</span><span class="n">DataComponentConfig</span><span class="p">(</span>
        <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;huggingface_dataset&quot;</span><span class="p">,</span>
        <span class="n">params</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&quot;data_dir&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
            <span class="s2">&quot;data_name&quot;</span><span class="p">:</span> <span class="s2">&quot;glue&quot;</span><span class="p">,</span>
            <span class="s2">&quot;subset&quot;</span><span class="p">:</span> <span class="s2">&quot;mrpc&quot;</span><span class="p">,</span>
            <span class="s2">&quot;split&quot;</span><span class="p">:</span> <span class="s2">&quot;validation&quot;</span><span class="p">,</span>
            <span class="s2">&quot;data_files&quot;</span><span class="p">:</span> <span class="n">null</span>
        <span class="p">}</span>
    <span class="p">),</span>
    <span class="n">pre_process_data_config</span><span class="o">=</span><span class="n">DataComponentConfig</span><span class="p">(</span>
        <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;huggingface_pre_process&quot;</span><span class="p">,</span>
        <span class="n">params</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&quot;model_name&quot;</span><span class="p">:</span> <span class="s2">&quot;Intel/bert-base-uncased-mrpc&quot;</span><span class="p">,</span>
            <span class="s2">&quot;input_cols&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="s2">&quot;sentence1&quot;</span><span class="p">,</span>
                <span class="s2">&quot;sentence2&quot;</span>
            <span class="p">],</span>
            <span class="s2">&quot;label_cols&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="s2">&quot;label&quot;</span>
            <span class="p">],</span>
            <span class="s2">&quot;max_samples&quot;</span><span class="p">:</span> <span class="n">null</span>
        <span class="p">}</span>
    <span class="p">),</span>
    <span class="n">post_process_data_config</span><span class="o">=</span><span class="n">DataComponentConfig</span><span class="p">(</span>
        <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text_classification_post_process&quot;</span><span class="p">,</span>
        <span class="n">params</span><span class="o">=</span><span class="p">{}</span>
    <span class="p">),</span>
    <span class="n">dataloader_config</span><span class="o">=</span><span class="n">DataComponentConfig</span><span class="p">(</span>
        <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;default_dataloader&quot;</span><span class="p">,</span>
        <span class="n">params</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&quot;batch_size&quot;</span><span class="p">:</span> <span class="mi">1</span>
        <span class="p">}</span>
    <span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div></div>
</section>
<section id="configs-with-customized-component">
<h3>Configs with customized component:<a class="headerlink" href="#configs-with-customized-component" title="Permalink to this heading">¶</a></h3>
<p>The above case shows to rewrite all the components in data config. But sometime, there is no need to rewrite all the components. For example, if we only want to customize the <code class="docutils literal notranslate"><span class="pre">load_dataset</span></code> component for <code class="docutils literal notranslate"><span class="pre">DataContainer</span></code>, we can just rewrite the <code class="docutils literal notranslate"><span class="pre">load_dataset</span></code> component in the data config and ignore the other default components.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-5-5-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-5-5-0" name="5-0" role="tab" tabindex="0">Config JSON</button><button aria-controls="panel-5-5-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-5-5-1" name="5-1" role="tab" tabindex="-1">Python Class</button></div><div aria-labelledby="tab-5-5-0" class="sphinx-tabs-panel" id="panel-5-5-0" name="5-0" role="tabpanel" tabindex="0"><div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;data&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;DataContainer&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;user_script&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;user_script.py&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;script_dir&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;user_dir&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;load_dataset_config&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;customized_huggingface_dataset&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;params&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;data_dir&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;data_name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;glue&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;subset&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;mrpc&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-5-5-1" class="sphinx-tabs-panel" hidden="true" id="panel-5-5-1" name="5-1" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">olive.data.registry</span> <span class="kn">import</span> <span class="n">Registry</span>

<span class="nd">@Registry</span><span class="o">.</span><span class="n">register_dataset</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">customized_huggingface_dataset</span><span class="p">(</span><span class="n">_output</span><span class="p">,</span> <span class="n">trust_remote_code</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="o">...</span>

<span class="kn">from</span> <span class="nn">olive.data.config</span> <span class="kn">import</span> <span class="n">DataConfig</span>
<span class="n">data_config</span> <span class="o">=</span> <span class="n">DataConfig</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">,</span>
    <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;DataContainer&quot;</span><span class="p">,</span>
    <span class="n">user_script</span><span class="o">=</span><span class="s2">&quot;user_script.py&quot;</span><span class="p">,</span>
    <span class="n">script_dir</span><span class="o">=</span><span class="s2">&quot;user_dir&quot;</span><span class="p">,</span>
    <span class="n">load_dataset_config</span><span class="o">=</span><span class="n">DataComponentConfig</span><span class="p">(</span>
        <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;customized_huggingface_dataset&quot;</span><span class="p">,</span>
        <span class="n">params</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&quot;data_dir&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span>
            <span class="s2">&quot;data_name&quot;</span><span class="p">:</span> <span class="s2">&quot;glue&quot;</span><span class="p">,</span>
            <span class="s2">&quot;subset&quot;</span><span class="p">:</span> <span class="s2">&quot;mrpc&quot;</span><span class="p">,</span>
        <span class="p">}</span>
    <span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>User should provide the <code class="docutils literal notranslate"><span class="pre">user_script</span></code> and <code class="docutils literal notranslate"><span class="pre">script_dir</span></code> if they want to customize the component type. The <code class="docutils literal notranslate"><span class="pre">user_script</span></code> should be a python script which contains the customized component type. The <code class="docutils literal notranslate"><span class="pre">script_dir</span></code> should be the directory path which contains the <code class="docutils literal notranslate"><span class="pre">user_script</span></code>. Another thing you might need to notice is that when your customized dataset is from huggingface, you should at least allow the <code class="docutils literal notranslate"><span class="pre">trust_remote_code</span></code> in your function’s arguments list to indicate whether you trust the remote code or not. <code class="docutils literal notranslate"><span class="pre">kwargs</span></code> is the additional keyword arguments provided in the config, it can cover the case of <code class="docutils literal notranslate"><span class="pre">trust_remote_code</span></code> as well.
Here is an example for <code class="docutils literal notranslate"><span class="pre">user_script</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">olive.data.registry</span> <span class="kn">import</span> <span class="n">Registry</span>

<span class="nd">@Registry</span><span class="o">.</span><span class="n">register_dataset</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">customized_huggingface_dataset</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="c1"># kwargs can cover the case of trust_remote_code or user can add trust_remote_code in the function&#39;s</span>
    <span class="c1"># arguments list, like, customized_huggingface_dataset(data_dir, trust_remote_code=None, **kwargs):</span>
    <span class="o">...</span>

<span class="nd">@Registry</span><span class="o">.</span><span class="n">register_pre_process</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">customized_huggingface_pre_process</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="o">...</span>

<span class="nd">@Registry</span><span class="o">.</span><span class="n">register_post_process</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">customized_post_process</span><span class="p">(</span><span class="n">output</span><span class="p">):</span>
    <span class="o">...</span>

<span class="nd">@Registry</span><span class="o">.</span><span class="n">register_dataloader</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">customized_dataloader</span><span class="p">(</span><span class="n">dataset</span><span class="p">):</span>
    <span class="o">...</span>
</pre></div>
</div>
<dl class="simple">
<dt>More examples:</dt><dd><ol class="arabic simple">
<li><dl class="simple">
<dt>inception_post_process:</dt><dd><ul class="simple">
<li><p>user_script <a class="reference external" href="https://github.com/microsoft/Olive/blob/main/examples/inception/user_script.py#L8-L10">https://github.com/microsoft/Olive/blob/main/examples/inception/user_script.py#L8-L10</a></p></li>
<li><p>json_config <a class="reference external" href="https://github.com/microsoft/Olive/blob/main/examples/inception/inception_config.json#L14-L16">https://github.com/microsoft/Olive/blob/main/examples/inception/inception_config.json#L14-L16</a></p></li>
</ul>
</dd>
</dl>
</li>
</ol>
</dd>
</dl>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<dl class="simple">
<dt>The components will be called with the following arguments along with any additional keyword arguments provided in the config:</dt><dd><ul class="simple">
<li><p>load_dataset: <code class="docutils literal notranslate"><span class="pre">data_dir</span></code> (required, but the type can be <cite>Optional[str]</cite>)</p></li>
<li><p>pre_process_data: <code class="docutils literal notranslate"><span class="pre">dataset</span></code> (required, must be the first argument)</p></li>
<li><p>post_process_data: <code class="docutils literal notranslate"><span class="pre">output</span></code> (required, must be the first argument)</p></li>
<li><p>dataloader: <code class="docutils literal notranslate"><span class="pre">dataset</span></code> (required, must be the first argument)</p></li>
</ul>
</dd>
</dl>
<p>the required arguments for <code class="docutils literal notranslate"><span class="pre">pre_process_data/post_process_data/dataloader</span></code> must start with <code class="docutils literal notranslate"><span class="pre">_</span></code> to avoid the conflict with the additional keyword arguments provided in the config.</p>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="configure_pass.html" class="btn btn-neutral float-left" title="How To Configure Pass" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="configure_model_path.html" class="btn btn-neutral float-right" title="How To Set Model Path" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, olivedevteam@microsoft.com.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>