
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>How to Setup Custom Dataset for Calibration and Evaluation &#8212; Olive latest documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/autodoc_pydantic.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/header.css?v=5dcc4e7b" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../../_static/jquery.js?v=5d32c60e"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="../../_static/documentation_options.js?v=c6e86fd7"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'how-to/configure-workflows/how-to-configure-data';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_version = '0.16.1';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = 'https://microsoft.github.io/Olive/_static/versions.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = 'latest';
        DOCUMENTATION_OPTIONS.show_version_warning_banner =
            true;
        </script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="How to Define Evaluation Metrics" href="metrics-configuration.html" />
    <link rel="prev" title="How to Customize a Pass Parameters" href="pass-configuration.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="latest" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class=" navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
  
    <p class="title logo__title">Olive latest documentation</p>
  
</a></div>
    
  </div>
  
  <div class=" navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../why-olive.html">
    Overview
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../getting-started/getting-started.html">
    Getting started
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../index.html">
    How Tos
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../examples.html">
    Examples
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button"
                data-bs-toggle="dropdown" aria-expanded="false"
                aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../features/index.html">
    Features
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../reference/index.html">
    Reference
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">
<div class="version-switcher__container dropdown pst-js-only">
  <button id="pst-version-switcher-button-2"
    type="button"
    class="version-switcher__button btn btn-sm dropdown-toggle"
    data-bs-toggle="dropdown"
    aria-haspopup="listbox"
    aria-controls="pst-version-switcher-list-2"
    aria-label="Version switcher list"
  >
    Choose version  <!-- this text may get changed later by javascript -->
    <span class="caret"></span>
  </button>
  <div id="pst-version-switcher-list-2"
    class="version-switcher__menu dropdown-menu list-group-flush py-0"
    role="listbox" aria-labelledby="pst-version-switcher-button-2">
    <!-- dropdown will be populated by javascript on page load -->
  </div>
</div></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar hide-on-wide">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../why-olive.html">
    Overview
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../getting-started/getting-started.html">
    Getting started
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../index.html">
    How Tos
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../examples.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../features/index.html">
    Features
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../reference/index.html">
    Reference
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<div class="version-switcher__container dropdown pst-js-only">
  <button id="pst-version-switcher-button-3"
    type="button"
    class="version-switcher__button btn btn-sm dropdown-toggle"
    data-bs-toggle="dropdown"
    aria-haspopup="listbox"
    aria-controls="pst-version-switcher-list-3"
    aria-label="Version switcher list"
  >
    Choose version  <!-- this text may get changed later by javascript -->
    <span class="caret"></span>
  </button>
  <div id="pst-version-switcher-list-3"
    class="version-switcher__menu dropdown-menu list-group-flush py-0"
    role="listbox" aria-labelledby="pst-version-switcher-button-3">
    <!-- dropdown will be populated by javascript on page load -->
  </div>
</div></div>
        
      </div>
    
  </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../index.html" class="nav-link">How Tos</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">How to Setup Custom Dataset for Calibration and Evaluation</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="how-to-setup-custom-dataset-for-calibration-and-evaluation">
<h1>How to Setup Custom Dataset for Calibration and Evaluation<a class="headerlink" href="#how-to-setup-custom-dataset-for-calibration-and-evaluation" title="Link to this heading">#</a></h1>
<p>Olive Data config organizes the data loading, preprocessing, batching and post processing into a single json config and defines several <strong>popular templates</strong> to serve Olive optimization.</p>
<p>The configuration of Olive data config is positioned under Olive run config with the field of <code class="docutils literal notranslate"><span class="pre">data_configs</span></code>, which is a list of data config items.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;data_configs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;dataset_1&quot;</span><span class="p">,</span><span class="w"> </span><span class="cm">/* additional config here */</span><span class="w"> </span><span class="p">},</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;dataset_2&quot;</span><span class="p">,</span><span class="w"> </span><span class="cm">/* additional config here */</span><span class="w"> </span><span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">name</span></code> for each dataset should be unique, and must be composed letters, numbers, and underscores.</p>
</div>
<p>Then if there is any requirement to leverage the data config in Olive passes/evaluator, we can simply refer to the data config <strong>key name</strong>.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="nt">&quot;evaluators&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;common_evaluator&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;data_config&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;dataset_1&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">},</span>
<span class="nt">&quot;passes&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;common_pass&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;data_config&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;dataset_2&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Before deep dive to the generic data config, let’s first take a look at the data config template.</p>
<section id="supported-data-config-template">
<h2>Supported Data Config Template<a class="headerlink" href="#supported-data-config-template" title="Link to this heading">#</a></h2>
<p>The data config template is defined in (<code class="docutils literal notranslate"><span class="pre">olive.data.template</span></code>)[https://github.com/microsoft/Olive/blob/main/olive/data/template.py] module which is used to create <code class="docutils literal notranslate"><span class="pre">data_config</span></code> easily.</p>
<p>Currently, Olive supports the following data container which can be generated from <code class="docutils literal notranslate"><span class="pre">olive.data.template</span></code>:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">DummyDataContainer</span></code>: Convert the dummy data config to the data container.</p></li>
</ol>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;dummy_data_config_template&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;DummyDataContainer&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;load_dataset_config&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;input_shapes&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">128</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">128</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">128</span><span class="p">]],</span>
<span class="w">        </span><span class="nt">&quot;input_names&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;input_ids&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;attention_mask&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;token_type_ids&quot;</span><span class="p">],</span>
<span class="w">        </span><span class="nt">&quot;input_types&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;int64&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;int64&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;int64&quot;</span><span class="p">],</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">HuggingfaceContainer</span></code>: Convert the huggingface data config to the data container.</p></li>
</ol>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;huggingface_data_config&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;HuggingfaceContainer&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;load_dataset_config&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;data_name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;glue&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;split&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;validation&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;subset&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;mrpc&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;pre_process_data_config&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;model_name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Intel/bert-base-uncased-mrpc&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;task&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;text-classification&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;input_cols&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;sentence1&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;sentence2&quot;</span><span class="p">],</span>
<span class="w">        </span><span class="nt">&quot;label_col&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;label&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;post_process_data_config&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;task&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;text-classification&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;dataloader_config&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;batch_size&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">RawDataContainer</span></code>: Convert the raw data config to the data container.</p></li>
</ol>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;raw_data&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;RawDataContainer&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;load_dataset_config&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;data_dir&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;data&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;input_names&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;data&quot;</span><span class="p">],</span>
<span class="w">        </span><span class="nt">&quot;input_shapes&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">224</span><span class="p">,</span><span class="w"> </span><span class="mi">224</span><span class="p">]],</span>
<span class="w">        </span><span class="nt">&quot;input_dirs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;.&quot;</span><span class="p">],</span>
<span class="w">        </span><span class="nt">&quot;input_suffix&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;.raw&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;input_order_file&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;input_order.txt&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">TransformersDummyDataContainer</span></code>: Convert the transformer dummy data config to the data container.</p></li>
</ol>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;transformers_dummy_data_config&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;TransformersDummyDataContainer&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Also, based on <code class="docutils literal notranslate"><span class="pre">TransformersDummyDataContainer</span></code>, Olive provides templates for transformer inference based on prompt(first prediction, no kv_cache now) and token(with kv_cache) inputs.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">TransformersPromptDummyDataContainer</span></code> where <code class="docutils literal notranslate"><span class="pre">seq_len</span> <span class="pre">&gt;=</span> <span class="pre">1</span></code> (default 8) and <code class="docutils literal notranslate"><span class="pre">past_seq_len</span> <span class="pre">=</span> <span class="pre">0</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">TransformersTokenDummyDataContainer</span></code> where <code class="docutils literal notranslate"><span class="pre">seq_len</span> <span class="pre">==</span> <span class="pre">1</span></code> and <code class="docutils literal notranslate"><span class="pre">past_seq_len</span> <span class="pre">&gt;=</span> <span class="pre">1</span></code> (default 8).</p></li>
</ul>
<section id="generic-data-config">
<h3>Generic Data Config<a class="headerlink" href="#generic-data-config" title="Link to this heading">#</a></h3>
<p>If no data config template can meet the requirement, we can also define the (data config)[https://github.com/microsoft/Olive/blob/main/olive/data/config.py#L35] directly. The data config is defined as a dictionary which includes the following fields:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code>: the name of the data config.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">type</span></code>: the type name of the data config. Available <code class="docutils literal notranslate"><span class="pre">type</span></code>:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/microsoft/Olive/blob/main/olive/data/container/data_container.py#L17"><code class="docutils literal notranslate"><span class="pre">DataContainer</span></code></a>: the base class of all data config.</p></li>
<li><p><a class="reference external" href="https://github.com/microsoft/Olive/blob/main/olive/data/template.py#L9"><code class="docutils literal notranslate"><span class="pre">DummyDataContainer</span></code></a></p></li>
<li><p><a class="reference external" href="https://github.com/microsoft/Olive/blob/main/olive/data/template.py#L9"><code class="docutils literal notranslate"><span class="pre">HuggingfaceContainer</span></code></a></p></li>
<li><p><a class="reference external" href="https://github.com/microsoft/Olive/blob/main/olive/data/template.py#L72"><code class="docutils literal notranslate"><span class="pre">RawDataContainer</span></code></a></p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">components</span></code>: the dictionary of four <a class="reference external" href="https://github.com/microsoft/Olive/blob/main/olive/data/constants.py#L12">components</a> which contain:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Components</p></th>
<th class="head"><p>Available component type</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference external" href="https://github.com/microsoft/Olive/blob/main/olive/data/component/load_dataset.py"><code class="docutils literal notranslate"><span class="pre">load_dataset</span></code></a></p></td>
<td><p>local_dataset(default), simple_dataset, huggingface_dataset, raw_dataset</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="https://github.com/microsoft/Olive/blob/main/olive/data/component/pre_process_data.py"><code class="docutils literal notranslate"><span class="pre">pre_process_data</span></code></a></p></td>
<td><p>pre_process(default), huggingface_pre_process, ner_huggingface_preprocess, text_generation_huggingface_pre_process</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference external" href="https://github.com/microsoft/Olive/blob/main/olive/data/component/post_process_data.py"><code class="docutils literal notranslate"><span class="pre">post_process_data</span></code></a></p></td>
<td><p>post_process(default), text_classification_post_process, ner_post_process, text_generation_post_process</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="https://github.com/microsoft/Olive/blob/main/olive/data/component/dataloader.py"><code class="docutils literal notranslate"><span class="pre">dataloader</span></code></a></p></td>
<td><p>default_dataloader(default), no_auto_batch_dataloader</p></td>
</tr>
</tbody>
</table>
</div>
<p>each component can be customized by the following fields:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code>: the name of the component.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">type</span></code>: the type name of the available component type. Besides the above available type in above table, user can also define their own component type in <code class="docutils literal notranslate"><span class="pre">user_script</span></code> with the way Olive does for <a class="reference external" href="https://github.com/microsoft/Olive/blob/main/olive/data/component/load_dataset.py#L26"><code class="docutils literal notranslate"><span class="pre">huggingface_dataset</span></code></a>. In this way, they need to provide <code class="docutils literal notranslate"><span class="pre">user_script</span></code> and <code class="docutils literal notranslate"><span class="pre">script_dir</span></code>. There is an <a class="reference external" href="https://github.com/microsoft/Olive/blob/main/examples/resnet/user_script.py#L77%3E">example</a> with customized component type.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">params</span></code>: the dictionary of component function parameters. The key is the parameter name for given component type and the value is the parameter value.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">user_script</span></code>: the user script path which contains the customized component type.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">script_dir</span></code>: the user script directory path which contains the customized script.</p></li>
</ul>
</section>
<section id="configs-with-built-in-component">
<h3>Configs with built-in component<a class="headerlink" href="#configs-with-built-in-component" title="Link to this heading">#</a></h3>
<p>Then the complete config would be like:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;data&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;DataContainer&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;load_dataset_config&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;huggingface_dataset&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;data_dir&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;data_name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;glue&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;subset&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;mrpc&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;split&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;validation&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;data_files&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;pre_process_data_config&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;huggingface_pre_process&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;model_name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Intel/bert-base-uncased-mrpc&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;input_cols&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">            </span><span class="s2">&quot;sentence1&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s2">&quot;sentence2&quot;</span>
<span class="w">        </span><span class="p">],</span>
<span class="w">        </span><span class="nt">&quot;label_col&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;label&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;max_samples&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;post_process_data_config&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;text_classification_post_process&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;dataloader_config&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;default_dataloader&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;batch_size&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="configs-with-customized-component">
<h3>Configs with customized component<a class="headerlink" href="#configs-with-customized-component" title="Link to this heading">#</a></h3>
<p>The above case shows to rewrite all the components in data config. But sometime, there is no need to rewrite all the components. For example, if we only want to customize the <code class="docutils literal notranslate"><span class="pre">load_dataset</span></code> component for <code class="docutils literal notranslate"><span class="pre">DataContainer</span></code>, we can just rewrite the <code class="docutils literal notranslate"><span class="pre">load_dataset</span></code> component in the data config and ignore the other default components.</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;data&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;DataContainer&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;user_script&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;user_script.py&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;script_dir&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;user_dir&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;load_dataset_config&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;customized_huggingface_dataset&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;data_dir&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;data_name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;glue&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;subset&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;mrpc&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You should provide the <code class="docutils literal notranslate"><span class="pre">user_script</span></code> and <code class="docutils literal notranslate"><span class="pre">script_dir</span></code> if you want to customize the component type. The <code class="docutils literal notranslate"><span class="pre">user_script</span></code> should be a python script which contains the customized component type. The <code class="docutils literal notranslate"><span class="pre">script_dir</span></code> should be the directory path which contains the <code class="docutils literal notranslate"><span class="pre">user_script</span></code>. If your customized dataset is from Hugging Face, you should at least allow the <code class="docutils literal notranslate"><span class="pre">trust_remote_code</span></code> in your function’s arguments list to indicate whether you trust the remote code or not. <code class="docutils literal notranslate"><span class="pre">kwargs</span></code> is the additional keyword arguments provided in the config, it can cover the case of <code class="docutils literal notranslate"><span class="pre">trust_remote_code</span></code> as well.</p>
<p>Here is an example for <code class="docutils literal notranslate"><span class="pre">user_script</span></code>:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>from olive.data.registry import Registry

@Registry.register_dataset()
def customized_huggingface_dataset(data_dir, **kwargs):
    # kwargs can cover the case of trust_remote_code or user can add trust_remote_code in the function&#39;s
    # arguments list, like, customized_huggingface_dataset(data_dir, trust_remote_code=None, **kwargs):

    # ...

@Registry.register_pre_process()
def customized_huggingface_pre_process(dataset, **kwargs):
    # ...

@Registry.register_post_process()
def customized_post_process(output):
    # ...

@Registry.register_dataloader()
def customized_dataloader(dataset):
    # ...
</pre></div>
</div>
<p>Some examples:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/microsoft/Olive/blob/main/examples/resnet/user_script.py#L76-L82">user_script</a></p></li>
<li><p><a class="reference external" href="https://github.com/microsoft/Olive/blob/main/examples/resnet/resnet_ptq_cpu.json#L24">The <code class="docutils literal notranslate"><span class="pre">json_config</span></code></a></p></li>
</ul>
<p>The components will be called with the following arguments along with any additional keyword arguments provided in the config:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">load_dataset</span></code>: <code class="docutils literal notranslate"><span class="pre">data_dir</span></code> (required, but the type can be <code class="docutils literal notranslate"><span class="pre">Optional[str]</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pre_process_data</span></code>: <code class="docutils literal notranslate"><span class="pre">dataset</span></code> (required, must be the first argument)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">post_process_data</span></code>: <code class="docutils literal notranslate"><span class="pre">output</span></code> (required, must be the first argument)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dataloader</span></code>: <code class="docutils literal notranslate"><span class="pre">dataset</span></code> (required, must be the first argument)</p></li>
</ul>
<p>the required arguments for <code class="docutils literal notranslate"><span class="pre">pre_process_data</span></code>/<code class="docutils literal notranslate"><span class="pre">post_process_data</span></code>/<code class="docutils literal notranslate"><span class="pre">dataloader</span></code> must start with <code class="docutils literal notranslate"><span class="pre">_</span></code> to avoid the conflict with the additional keyword arguments provided in the config.</p>
</div>
</section>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="pass-configuration.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">How to Customize a Pass Parameters</p>
      </div>
    </a>
    <a class="right-next"
       href="metrics-configuration.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">How to Define Evaluation Metrics</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#supported-data-config-template">Supported Data Config Template</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#generic-data-config">Generic Data Config</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#configs-with-built-in-component">Configs with built-in component</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#configs-with-customized-component">Configs with customized component</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2023-2025, Olive Dev team.
      <br/>
    
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>